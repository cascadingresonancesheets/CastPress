const payments=document.querySelectorAll(".billing-radio"),billingForms=document.querySelectorAll(".billing-radio__form"),billingFormsItems=document.querySelectorAll(".billing-radio__form input"),cSelects=(0<payments.length&&(payments.forEach(e=>{var t=e.querySelector(".custom-radio__input");let r=e.querySelector(".billing-radio__form"),s=e.querySelectorAll("input");t.onclick=function(){billingForms.forEach(e=>{e.style.display="none"}),r.style.display="flex",billingFormsItems.forEach(e=>{e.removeAttribute("form")}),s.forEach(e=>{e.setAttribute("form","billing-form")})}}),payments[0].querySelector(".custom-radio__input").click()),document.querySelectorAll(".custom-select")),humb=(cSelects.forEach(e=>{let r=e.querySelector("select").querySelectorAll("option"),t=document.createElement("DIV"),s=(t.setAttribute("class","custom-select__selected"),e.appendChild(t),e.querySelector(".custom-select__selected"));var o=document.createElement("DIV");o.setAttribute("class","custom-select__items"),e.appendChild(o);let l=e.querySelector(".custom-select__items"),a=0,c=(r.forEach(e=>{var t=document.createElement("DIV");t.setAttribute("class","custom-select__item"),t.setAttribute("data-index",a++),t.innerHTML=e.innerHTML,l.appendChild(t)}),l.querySelectorAll(".custom-select__item")),n=0;r.forEach(e=>{1==e.selected&&(c[n].classList.add("custom-select__item_is-selected"),t.innerHTML=r[n].innerHTML),n++}),s.addEventListener("click",function(){cSelects.forEach(e=>{e.querySelector(".custom-select__selected")!==this&&(e.querySelector(".custom-select__selected").classList.remove("custom-select__selected_is-open"),e.querySelector(".custom-select__items").classList.remove("custom-select__items_is-open"))}),this.classList.toggle("custom-select__selected_is-open"),this.nextElementSibling.classList.toggle("custom-select__items_is-open")}),l.addEventListener("click",function(e){var t;e.target.classList.contains("custom-select__item")&&(t=e.target.innerHTML,s.innerHTML=t,t=e.target.dataset.index,r[t].selected="selected",c.forEach(e=>{e.classList.remove("custom-select__item_is-selected")}),e.target.classList.add("custom-select__item_is-selected"),e.target.parentNode.classList.remove("custom-select__items_is-open"),e.target.parentNode.previousElementSibling.classList.remove("custom-select__selected_is-open"))})}),document.addEventListener("click",e=>{e.target.closest(".custom-select")||document.querySelectorAll(".custom-select").forEach(e=>{e.querySelector(".custom-select__selected").classList.remove("custom-select__selected_is-open"),e.querySelector(".custom-select__items").classList.remove("custom-select__items_is-open")})}),document.querySelector(".humb")),topnav=document.querySelector(".topnav"),searchBtn=(humb.onclick=function(){humb.classList.toggle("humb_is-open"),topnav.classList.toggle("topnav_is-open")},document.addEventListener("click",e=>{e.target.closest(".header")||e.target.closest(".humb")||(humb.classList.remove("humb_is-open"),topnav.classList.remove("topnav_is-open"))}),document.querySelector(".search-icon")),searchCross=document.querySelector(".search-icon__cross"),searchSvg=document.querySelector(".search-icon__svg"),searchField=document.querySelector(".header-search"),subMenus=(searchBtn.onclick=function(){searchField.classList.toggle("header-search_active"),searchCross.classList.toggle("search-icon__cross_active"),searchSvg.classList.toggle("search-icon__svg_hidden")},document.addEventListener("click",e=>{e.target.closest(".header-search")||e.target.closest(".search-icon")||(searchField.classList.remove("header-search_active"),searchCross.classList.remove("search-icon__cross_active"),searchSvg.classList.remove("search-icon__svg_hidden"))}),document.querySelectorAll(".topnav__item_has-submenu")),player=(subMenus.forEach(e=>{let t=e.querySelector(".submenu-toggle"),r=e.querySelector(".topnav__submenu");t.onclick=function(){t.classList.toggle("submenu-toggle_open"),r.classList.toggle("topnav__submenu_is-open")}}),window.addEventListener("resize",()=>{subMenus.forEach(e=>{var t=e.querySelector(".submenu-toggle"),e=e.querySelector(".topnav__submenu");t.classList.remove("submenu-toggle_open"),e.classList.remove("topnav__submenu_is-open")}),humb.classList.remove("humb_is-open"),topnav.classList.remove("topnav_is-open")}),document.getElementById("player")),playerPlay=document.querySelector(".player__play"),playerPlaySVG=document.querySelector(".player__play-svg"),playerPauseSVG=document.querySelector(".player__pause-svg"),playerCurrentTime=document.querySelector(".player__current-time"),playerPlayTime=document.querySelector(".player__play-time"),playerProgressBar=document.querySelector(".player__progress-bar"),playerProgress=document.querySelector(".player__progress"),playerVolume=document.querySelector(".player__volume"),playerVolumeSVG=document.querySelector(".player__volume-svg"),playerVolumeMutedSVG=document.querySelector(".player__volume_muted-svg"),playerVolumeBar=document.querySelector(".player__volume-bar"),playerVolumeValue=document.querySelector(".player__volume-value");if(player){localStorage.volume&&(player.volume=localStorage.volume,playerVolumeValue.style.height=100*player.volume*.7+"px");let e=setInterval(()=>{},500);function timePrettier(e){var e=parseInt(e,10),t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60),e=e-3600*t-60*r;return(t=t<10?"0"+t:t)+":"+(r=r<10?"0"+r:r)+":"+(e=e<10?"0"+e:e)}function getMinutes(e){e=parseInt(e,10);return Math.floor(e/60)}function getRelativeCoordinates(e,t){const r=e.pageX;e.pageY;var s={left:t.offsetLeft,top:t.offsetTop};let o=t.offsetParent;for(;o;)s.left+=o.offsetLeft,s.top+=o.offsetTop,o=o.offsetParent;return r-s.left}function getRelativeCoordinatesV(e,t){e.pageX;const r=e.pageY;var s={left:t.offsetLeft,top:t.offsetTop};let o=t.offsetParent;for(;o;)s.left+=o.offsetLeft,s.top+=o.offsetTop,o=o.offsetParent;return r-s.top}clearInterval(e),player.addEventListener("loadedmetadata",function(){playerPlayTime.innerHTML=timePrettier(Math.round(player.duration));var e=document.querySelector(".transcript__caption span");e&&(e.innerHTML=getMinutes(Math.round(player.duration)))}),player.addEventListener("ended",function(){playerPlaySVG.classList.add("player__play-svg_is-active"),playerPauseSVG.classList.remove("player__pause-svg_is-active")}),playerPlay.onclick=function(){player.paused?(player.play(),e=setInterval(()=>{var e=Math.round(player.currentTime);playerCurrentTime.innerHTML=timePrettier(e),playerProgress.style.width=e/(player.duration/100)+"%"},500)):(player.pause(),clearInterval(e))},player.addEventListener("play",()=>{playerPlaySVG.classList.remove("player__play-svg_is-active"),playerPauseSVG.classList.add("player__pause-svg_is-active")}),player.addEventListener("pause",()=>{playerPlaySVG.classList.add("player__play-svg_is-active"),playerPauseSVG.classList.remove("player__pause-svg_is-active")}),playerProgressBar.addEventListener("click",e=>{playerProgress.style.width=getRelativeCoordinates(e,e.target)+"px",player.currentTime=player.duration/100*(getRelativeCoordinates(e,e.target)/(playerProgressBar.offsetWidth/100));e=Math.round(player.currentTime);playerCurrentTime.innerHTML=timePrettier(e)}),playerVolume.onclick=function(){playerVolumeSVG.classList.toggle("player__volume-svg_is-active"),playerVolumeMutedSVG.classList.toggle("player__volume_muted-svg_is-active"),player.muted?player.muted=!1:player.muted=!0},playerVolumeBar.addEventListener("click",e=>{playerVolumeValue.style.height=70-getRelativeCoordinatesV(e,playerVolumeBar)+"px",player.volume=1-playerVolumeValue.offsetTop/(playerVolumeBar.offsetTop/100)/-100,localStorage.setItem("volume",player.volume),console.log(player.volume)})}Share={vkontakte:function(e,t,r,s){url="http://vkontakte.ru/share.php?",url=(url=(url=(url+="url="+encodeURIComponent(e))+"&title="+encodeURIComponent(t))+"&description="+encodeURIComponent(s))+"&image="+encodeURIComponent(r)+"&noparse=true",Share.popup(url)},facebook:function(e,t,r,s){url="http://www.facebook.com/sharer.php?s=100",url=(url=(url=(url+="&p[title]="+encodeURIComponent(t))+"&p[summary]="+encodeURIComponent(s))+"&p[url]="+encodeURIComponent(e))+"&p[images][0]="+encodeURIComponent(r),Share.popup(url)},twitter:function(e,t){url="http://twitter.com/share?",url=(url=(url+="text="+encodeURIComponent(t))+"&url="+encodeURIComponent(e))+"&counturl="+encodeURIComponent(e),Share.popup(url)},popup:function(e){window.open(e,"","toolbar=0,status=0,width=626,height=436")}};const productBtns=Array.from(document.querySelectorAll(".product-tabs__btn")),productTabs=Array.from(document.querySelectorAll(".product-descr__item")),productReview=document.querySelector(".rating__link");function reviewClick(e,t){e.map(e=>{e.classList.remove("product-descr__item_active"),"review"===e.id&&e.classList.add("product-descr__item_active")}),t.map(e=>{e.classList.remove("product-tabs__btn_active"),"review"===e.dataset.tab&&e.classList.add("product-tabs__btn_active")})}productReview&&productReview.addEventListener("click",function(){reviewClick(productTabs,productBtns)}),productBtns.map(t=>{t.addEventListener("click",function(){productTabs.map(e=>{e.classList.remove("product-descr__item_active"),t.dataset.tab===e.id&&e.classList.add("product-descr__item_active")}),productBtns.map(e=>{e.classList.remove("product-tabs__btn_active"),this.classList.add("product-tabs__btn_active")})})});const accBtns=Array.from(document.querySelectorAll(".account-tabs__btn")),accTabs=Array.from(document.querySelectorAll(".account-item"));accBtns.map(t=>{t.addEventListener("click",function(){accTabs.map(e=>{e.classList.add("account-item_hidden"),t.dataset.tab===e.id&&e.classList.remove("account-item_hidden")}),accBtns.map(e=>{e.classList.remove("account-tabs__btn_active"),this.classList.add("account-tabs__btn_active")})})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJpbGxpbmcuanMiLCJjdXN0b20tc2VsZWN0LmpzIiwibWVudS5qcyIsInBsYXllci5qcyIsInNoYXJlLmpzIiwidGFicy5qcyJdLCJuYW1lcyI6WyJwYXltZW50cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImJpbGxpbmdGb3JtcyIsImJpbGxpbmdGb3Jtc0l0ZW1zIiwiY1NlbGVjdHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwibGV0IiwicmFkaW8iLCJlbCIsInF1ZXJ5U2VsZWN0b3IiLCJmb3JtIiwiaW5wdXRzIiwib25jbGljayIsInN0eWxlIiwiZGlzcGxheSIsInJlbW92ZUF0dHJpYnV0ZSIsInNldEF0dHJpYnV0ZSIsImNsaWNrIiwiaHVtYiIsIm9wdGlvbnMiLCJjU2VsZWN0IiwiYSIsImNyZWF0ZUVsZW1lbnQiLCJuZXdTZWxlY3QiLCJhcHBlbmRDaGlsZCIsImIiLCJuZXdPcHRpb25zV3JhcCIsImkiLCJuZXdPcHRpb25zIiwiaW5uZXJIVE1MIiwib3B0aW9uIiwiaiIsInNlbGVjdGVkIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRoaXMiLCJyZW1vdmUiLCJ0b2dnbGUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJlIiwiaW5kZXgiLCJ0YXJnZXQiLCJjb250YWlucyIsInZhbHVlIiwiZGF0YXNldCIsIm5ld09wdGlvbiIsInBhcmVudE5vZGUiLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiY2xvc2VzdCIsInRvcG5hdiIsInNlYXJjaEJ0biIsInNlYXJjaENyb3NzIiwic2VhcmNoU3ZnIiwic2VhcmNoRmllbGQiLCJzdWJNZW51cyIsInBsYXllciIsInN1Yk1lbnVCdG4iLCJzdWJNZW51IiwibWVudSIsIndpbmRvdyIsImdldEVsZW1lbnRCeUlkIiwicGxheWVyUGxheSIsInBsYXllclBsYXlTVkciLCJwbGF5ZXJQYXVzZVNWRyIsInBsYXllckN1cnJlbnRUaW1lIiwicGxheWVyUGxheVRpbWUiLCJwbGF5ZXJQcm9ncmVzc0JhciIsInBsYXllclByb2dyZXNzIiwicGxheWVyVm9sdW1lIiwicGxheWVyVm9sdW1lU1ZHIiwicGxheWVyVm9sdW1lTXV0ZWRTVkciLCJwbGF5ZXJWb2x1bWVCYXIiLCJwbGF5ZXJWb2x1bWVWYWx1ZSIsImxvY2FsU3RvcmFnZSIsInZvbHVtZSIsImhlaWdodCIsImN1cnJlbnRUaW1lIiwic2V0SW50ZXJ2YWwiLCJ0aW1lUHJldHRpZXIiLCJ0aW1lIiwic2VjX251bSIsInBhcnNlSW50IiwiaG91cnMiLCJNYXRoIiwiZmxvb3IiLCJtaW51dGVzIiwic2Vjb25kcyIsImdldE1pbnV0ZXMiLCJnZXRSZWxhdGl2ZUNvb3JkaW5hdGVzIiwiZXZlbnQiLCJyZWZlcmVuY2VFbGVtZW50IiwicG9zaXRpb24iLCJwYWdlWCIsInBhZ2VZIiwib2Zmc2V0IiwibGVmdCIsIm9mZnNldExlZnQiLCJ0b3AiLCJvZmZzZXRUb3AiLCJyZWZlcmVuY2UiLCJvZmZzZXRQYXJlbnQiLCJnZXRSZWxhdGl2ZUNvb3JkaW5hdGVzViIsImNsZWFySW50ZXJ2YWwiLCJyb3VuZCIsImR1cmF0aW9uIiwibWluc0luZm8iLCJwYXVzZWQiLCJwbGF5Iiwid2lkdGgiLCJwYXVzZSIsIm9mZnNldFdpZHRoIiwibXV0ZWQiLCJzZXRJdGVtIiwiY29uc29sZSIsImxvZyIsIlNoYXJlIiwidmtvbnRha3RlIiwicHVybCIsInB0aXRsZSIsInBpbWciLCJ0ZXh0IiwidXJsIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicG9wdXAiLCJmYWNlYm9vayIsInR3aXR0ZXIiLCJvcGVuIiwicHJvZHVjdEJ0bnMiLCJBcnJheSIsImZyb20iLCJwcm9kdWN0VGFicyIsInByb2R1Y3RSZXZpZXciLCJyZXZpZXdDbGljayIsIm1hcCIsInRhYiIsImlkIiwiYnRuIiwiYWNjQnRucyIsImFjY1RhYnMiXSwibWFwcGluZ3MiOiJBQUFBLE1BQUFBLFNBQUFDLFNBQUFDLGlCQUFBLGdCQUFBLEVBQ0FDLGFBQUFGLFNBQUFDLGlCQUFBLHNCQUFBLEVB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QUFBQyxJQUFBLDBCQUFBLENBQ0EsQ0FBQSxDQUNBLENBQUEsQ0FDQSxDQUFBLEVBRUEsTUFBQXdHLFFBQUFULE1BQUFDLEtBQUFuSSxTQUFBQyxpQkFBQSxvQkFBQSxDQUFBLEVBQ0EySSxRQUFBVixNQUFBQyxLQUFBbkksU0FBQUMsaUJBQUEsZUFBQSxDQUFBLEVBRUEwSSxRQUFBSixJQUFBLElBQ0FHLEVBQUF0RyxpQkFBQSxRQUFBLFdBQ0F3RyxRQUFBTCxJQUFBLElBQ0FDLEVBQUF0RyxVQUFBQyxJQUFBLHFCQUFBLEVBQ0F1RyxFQUFBNUYsUUFBQTBGLE1BQUFBLEVBQUFDLElBQ0FELEVBQUF0RyxVQUFBSSxPQUFBLHFCQUFBLENBRUEsQ0FBQSxFQUNBcUcsUUFBQUosSUFBQSxJQUNBRyxFQUFBeEcsVUFBQUksT0FBQSwwQkFBQSxFQUNBRCxLQUFBSCxVQUFBQyxJQUFBLDBCQUFBLENBQ0EsQ0FBQSxDQUNBLENBQUEsQ0FDQSxDQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBwYXltZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmlsbGluZy1yYWRpb1wiKTtcclxuY29uc3QgYmlsbGluZ0Zvcm1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5iaWxsaW5nLXJhZGlvX19mb3JtXCIpO1xyXG5jb25zdCBiaWxsaW5nRm9ybXNJdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYmlsbGluZy1yYWRpb19fZm9ybSBpbnB1dFwiKTtcclxuXHJcbmlmIChwYXltZW50cy5sZW5ndGggPiAwKSB7XHJcbiAgcGF5bWVudHMuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgIGxldCByYWRpbyA9IGVsLnF1ZXJ5U2VsZWN0b3IoXCIuY3VzdG9tLXJhZGlvX19pbnB1dFwiKTtcclxuICAgIGxldCBmb3JtID0gZWwucXVlcnlTZWxlY3RvcihcIi5iaWxsaW5nLXJhZGlvX19mb3JtXCIpO1xyXG4gICAgbGV0IGlucHV0cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbnB1dFwiKTtcclxuXHJcbiAgICByYWRpby5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICBiaWxsaW5nRm9ybXMuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgICBlbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIH0pO1xyXG4gICAgICBmb3JtLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcclxuXHJcbiAgICAgIGJpbGxpbmdGb3Jtc0l0ZW1zLmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKFwiZm9ybVwiKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpbnB1dHMuZm9yRWFjaCgoZWwpID0+IHtcclxuICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoXCJmb3JtXCIsIFwiYmlsbGluZy1mb3JtXCIpO1xyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIHBheW1lbnRzWzBdLnF1ZXJ5U2VsZWN0b3IoXCIuY3VzdG9tLXJhZGlvX19pbnB1dFwiKS5jbGljaygpO1xyXG59XHJcbiIsImNvbnN0IGNTZWxlY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jdXN0b20tc2VsZWN0XCIpO1xyXG5cclxuY1NlbGVjdHMuZm9yRWFjaCgoY1NlbGVjdCkgPT4ge1xyXG4gIGxldCBzZWxlY3QgPSBjU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoXCJzZWxlY3RcIik7XHJcbiAgbGV0IG9wdGlvbnMgPSBzZWxlY3QucXVlcnlTZWxlY3RvckFsbChcIm9wdGlvblwiKTtcclxuXHJcbiAgbGV0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpO1xyXG4gIGEuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjdXN0b20tc2VsZWN0X19zZWxlY3RlZFwiKTtcclxuICBjU2VsZWN0LmFwcGVuZENoaWxkKGEpO1xyXG4gIGxldCBuZXdTZWxlY3QgPSBjU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoXCIuY3VzdG9tLXNlbGVjdF9fc2VsZWN0ZWRcIik7XHJcblxyXG4gIGxldCBiID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkRJVlwiKTtcclxuICBiLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiY3VzdG9tLXNlbGVjdF9faXRlbXNcIik7XHJcbiAgY1NlbGVjdC5hcHBlbmRDaGlsZChiKTtcclxuICBsZXQgbmV3T3B0aW9uc1dyYXAgPSBjU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoXCIuY3VzdG9tLXNlbGVjdF9faXRlbXNcIik7XHJcblxyXG4gIGxldCBpID0gMDtcclxuICBvcHRpb25zLmZvckVhY2goKG9wdGlvbikgPT4ge1xyXG4gICAgbGV0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpO1xyXG4gICAgYS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImN1c3RvbS1zZWxlY3RfX2l0ZW1cIik7XHJcbiAgICBhLnNldEF0dHJpYnV0ZShcImRhdGEtaW5kZXhcIiwgaSsrKTtcclxuICAgIGEuaW5uZXJIVE1MID0gb3B0aW9uLmlubmVySFRNTDtcclxuICAgIG5ld09wdGlvbnNXcmFwLmFwcGVuZENoaWxkKGEpO1xyXG4gIH0pO1xyXG5cclxuICBsZXQgbmV3T3B0aW9ucyA9IG5ld09wdGlvbnNXcmFwLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY3VzdG9tLXNlbGVjdF9faXRlbVwiKTtcclxuXHJcbiAgbGV0IGogPSAwO1xyXG4gIG9wdGlvbnMuZm9yRWFjaCgob3B0aW9uKSA9PiB7XHJcbiAgICBpZiAob3B0aW9uLnNlbGVjdGVkID09IHRydWUpIHtcclxuICAgICAgbmV3T3B0aW9uc1tqXS5jbGFzc0xpc3QuYWRkKFwiY3VzdG9tLXNlbGVjdF9faXRlbV9pcy1zZWxlY3RlZFwiKTtcclxuICAgICAgYS5pbm5lckhUTUwgPSBvcHRpb25zW2pdLmlubmVySFRNTDtcclxuICAgIH1cclxuICAgIGorKztcclxuICB9KTtcclxuXHJcbiAgbmV3U2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBjU2VsZWN0cy5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICBpZiAoZWwucXVlcnlTZWxlY3RvcihcIi5jdXN0b20tc2VsZWN0X19zZWxlY3RlZFwiKSAhPT0gdGhpcykge1xyXG4gICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3IoXCIuY3VzdG9tLXNlbGVjdF9fc2VsZWN0ZWRcIikuY2xhc3NMaXN0LnJlbW92ZShcImN1c3RvbS1zZWxlY3RfX3NlbGVjdGVkX2lzLW9wZW5cIik7XHJcbiAgICAgICAgZWwucXVlcnlTZWxlY3RvcihcIi5jdXN0b20tc2VsZWN0X19pdGVtc1wiKS5jbGFzc0xpc3QucmVtb3ZlKFwiY3VzdG9tLXNlbGVjdF9faXRlbXNfaXMtb3BlblwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5jbGFzc0xpc3QudG9nZ2xlKFwiY3VzdG9tLXNlbGVjdF9fc2VsZWN0ZWRfaXMtb3BlblwiKTtcclxuICAgIHRoaXMubmV4dEVsZW1lbnRTaWJsaW5nLmNsYXNzTGlzdC50b2dnbGUoXCJjdXN0b20tc2VsZWN0X19pdGVtc19pcy1vcGVuXCIpO1xyXG4gIH0pO1xyXG5cclxuICBuZXdPcHRpb25zV3JhcC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjdXN0b20tc2VsZWN0X19pdGVtXCIpKSB7XHJcbiAgICAgIGxldCB2YWx1ZSA9IGUudGFyZ2V0LmlubmVySFRNTDtcclxuICAgICAgbmV3U2VsZWN0LmlubmVySFRNTCA9IHZhbHVlO1xyXG4gICAgICBsZXQgaW5kZXggPSBlLnRhcmdldC5kYXRhc2V0LmluZGV4O1xyXG4gICAgICBvcHRpb25zW2luZGV4XS5zZWxlY3RlZCA9IFwic2VsZWN0ZWRcIjtcclxuXHJcbiAgICAgIG5ld09wdGlvbnMuZm9yRWFjaCgobmV3T3B0aW9uKSA9PiB7XHJcbiAgICAgICAgbmV3T3B0aW9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXN0b20tc2VsZWN0X19pdGVtX2lzLXNlbGVjdGVkXCIpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJjdXN0b20tc2VsZWN0X19pdGVtX2lzLXNlbGVjdGVkXCIpO1xyXG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXN0b20tc2VsZWN0X19pdGVtc19pcy1vcGVuXCIpO1xyXG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnByZXZpb3VzRWxlbWVudFNpYmxpbmcuY2xhc3NMaXN0LnJlbW92ZShcImN1c3RvbS1zZWxlY3RfX3NlbGVjdGVkX2lzLW9wZW5cIik7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgaWYgKCFlLnRhcmdldC5jbG9zZXN0KFwiLmN1c3RvbS1zZWxlY3RcIikpIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY3VzdG9tLXNlbGVjdFwiKS5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICBlbC5xdWVyeVNlbGVjdG9yKFwiLmN1c3RvbS1zZWxlY3RfX3NlbGVjdGVkXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXN0b20tc2VsZWN0X19zZWxlY3RlZF9pcy1vcGVuXCIpO1xyXG4gICAgICBlbC5xdWVyeVNlbGVjdG9yKFwiLmN1c3RvbS1zZWxlY3RfX2l0ZW1zXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJjdXN0b20tc2VsZWN0X19pdGVtc19pcy1vcGVuXCIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59KTtcclxuIiwiLy8gSHVtYnVyZ2VyXHJcbmNvbnN0IGh1bWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmh1bWJcIik7XHJcbmNvbnN0IHRvcG5hdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudG9wbmF2XCIpO1xyXG5odW1iLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgaHVtYi5jbGFzc0xpc3QudG9nZ2xlKFwiaHVtYl9pcy1vcGVuXCIpO1xyXG4gIHRvcG5hdi5jbGFzc0xpc3QudG9nZ2xlKFwidG9wbmF2X2lzLW9wZW5cIik7XHJcbn07XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoXCIuaGVhZGVyXCIpICYmICFlLnRhcmdldC5jbG9zZXN0KFwiLmh1bWJcIikpIHtcclxuICAgIGh1bWIuY2xhc3NMaXN0LnJlbW92ZShcImh1bWJfaXMtb3BlblwiKTtcclxuICAgIHRvcG5hdi5jbGFzc0xpc3QucmVtb3ZlKFwidG9wbmF2X2lzLW9wZW5cIik7XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIFNlYXJjaFxyXG5jb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaC1pY29uXCIpO1xyXG5jb25zdCBzZWFyY2hDcm9zcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VhcmNoLWljb25fX2Nyb3NzXCIpO1xyXG5jb25zdCBzZWFyY2hTdmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNlYXJjaC1pY29uX19zdmdcIik7XHJcbmNvbnN0IHNlYXJjaEZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXItc2VhcmNoXCIpO1xyXG5cclxuc2VhcmNoQnRuLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgc2VhcmNoRmllbGQuY2xhc3NMaXN0LnRvZ2dsZShcImhlYWRlci1zZWFyY2hfYWN0aXZlXCIpO1xyXG4gIHNlYXJjaENyb3NzLmNsYXNzTGlzdC50b2dnbGUoXCJzZWFyY2gtaWNvbl9fY3Jvc3NfYWN0aXZlXCIpO1xyXG4gIHNlYXJjaFN2Zy5jbGFzc0xpc3QudG9nZ2xlKFwic2VhcmNoLWljb25fX3N2Z19oaWRkZW5cIik7XHJcbn07XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICBpZiAoIWUudGFyZ2V0LmNsb3Nlc3QoXCIuaGVhZGVyLXNlYXJjaFwiKSAmJiAhZS50YXJnZXQuY2xvc2VzdChcIi5zZWFyY2gtaWNvblwiKSkge1xyXG4gICAgc2VhcmNoRmllbGQuY2xhc3NMaXN0LnJlbW92ZShcImhlYWRlci1zZWFyY2hfYWN0aXZlXCIpO1xyXG4gICAgc2VhcmNoQ3Jvc3MuY2xhc3NMaXN0LnJlbW92ZShcInNlYXJjaC1pY29uX19jcm9zc19hY3RpdmVcIik7XHJcbiAgICBzZWFyY2hTdmcuY2xhc3NMaXN0LnJlbW92ZShcInNlYXJjaC1pY29uX19zdmdfaGlkZGVuXCIpO1xyXG4gIH1cclxufSk7XHJcblxyXG4vLyBTdWJtZW51XHJcbmNvbnN0IHN1Yk1lbnVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi50b3BuYXZfX2l0ZW1faGFzLXN1Ym1lbnVcIik7XHJcbnN1Yk1lbnVzLmZvckVhY2goKHN1Yk1lbnUpID0+IHtcclxuICBsZXQgc3ViTWVudUJ0biA9IHN1Yk1lbnUucXVlcnlTZWxlY3RvcihcIi5zdWJtZW51LXRvZ2dsZVwiKTtcclxuICBsZXQgbWVudSA9IHN1Yk1lbnUucXVlcnlTZWxlY3RvcihcIi50b3BuYXZfX3N1Ym1lbnVcIik7XHJcbiAgc3ViTWVudUJ0bi5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xyXG4gICAgc3ViTWVudUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwic3VibWVudS10b2dnbGVfb3BlblwiKTtcclxuICAgIG1lbnUuY2xhc3NMaXN0LnRvZ2dsZShcInRvcG5hdl9fc3VibWVudV9pcy1vcGVuXCIpO1xyXG4gIH07XHJcbn0pO1xyXG5cclxuLy8gQ2xvc2UgYWxsIG9uIHJlc2l6ZVxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiB7XHJcbiAgc3ViTWVudXMuZm9yRWFjaCgoc3ViTWVudSkgPT4ge1xyXG4gICAgbGV0IHN1Yk1lbnVCdG4gPSBzdWJNZW51LnF1ZXJ5U2VsZWN0b3IoXCIuc3VibWVudS10b2dnbGVcIik7XHJcbiAgICBsZXQgbWVudSA9IHN1Yk1lbnUucXVlcnlTZWxlY3RvcihcIi50b3BuYXZfX3N1Ym1lbnVcIik7XHJcbiAgICBzdWJNZW51QnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJzdWJtZW51LXRvZ2dsZV9vcGVuXCIpO1xyXG4gICAgbWVudS5jbGFzc0xpc3QucmVtb3ZlKFwidG9wbmF2X19zdWJtZW51X2lzLW9wZW5cIik7XHJcbiAgfSk7XHJcbiAgaHVtYi5jbGFzc0xpc3QucmVtb3ZlKFwiaHVtYl9pcy1vcGVuXCIpO1xyXG4gIHRvcG5hdi5jbGFzc0xpc3QucmVtb3ZlKFwidG9wbmF2X2lzLW9wZW5cIik7XHJcbn0pO1xyXG4iLCJjb25zdCBwbGF5ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKTtcclxuY29uc3QgcGxheWVyUGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX19wbGF5XCIpO1xyXG5jb25zdCBwbGF5ZXJQbGF5U1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3BsYXktc3ZnXCIpO1xyXG5jb25zdCBwbGF5ZXJQYXVzZVNWRyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX19wYXVzZS1zdmdcIik7XHJcbmNvbnN0IHBsYXllckN1cnJlbnRUaW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX2N1cnJlbnQtdGltZVwiKTtcclxuY29uc3QgcGxheWVyUGxheVRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllcl9fcGxheS10aW1lXCIpO1xyXG5jb25zdCBwbGF5ZXJQcm9ncmVzc0JhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX19wcm9ncmVzcy1iYXJcIik7XHJcbmNvbnN0IHBsYXllclByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3Byb2dyZXNzXCIpO1xyXG5cclxuY29uc3QgcGxheWVyVm9sdW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3ZvbHVtZVwiKTtcclxuY29uc3QgcGxheWVyVm9sdW1lU1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3ZvbHVtZS1zdmdcIik7XHJcbmNvbnN0IHBsYXllclZvbHVtZU11dGVkU1ZHID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3ZvbHVtZV9tdXRlZC1zdmdcIik7XHJcbmNvbnN0IHBsYXllclZvbHVtZUJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX192b2x1bWUtYmFyXCIpO1xyXG5jb25zdCBwbGF5ZXJWb2x1bWVWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyX192b2x1bWUtdmFsdWVcIik7XHJcblxyXG5pZiAocGxheWVyKSB7XHJcbiAgaWYgKGxvY2FsU3RvcmFnZS52b2x1bWUpIHtcclxuICAgIHBsYXllci52b2x1bWUgPSBsb2NhbFN0b3JhZ2Uudm9sdW1lO1xyXG4gICAgcGxheWVyVm9sdW1lVmFsdWUuc3R5bGUuaGVpZ2h0ID0gLjcgKiAocGxheWVyLnZvbHVtZSAqIDEwMCkgKyBcInB4XCI7XHJcbiAgfVxyXG5cclxuICBsZXQgY3VycmVudFRpbWUgPSBzZXRJbnRlcnZhbCgoKSA9PiB7fSwgNTAwKTtcclxuICBjbGVhckludGVydmFsKGN1cnJlbnRUaW1lKTtcclxuXHJcbiAgcGxheWVyLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkZWRtZXRhZGF0YVwiLCBmdW5jdGlvbigpIHtcclxuICAgIHBsYXllclBsYXlUaW1lLmlubmVySFRNTCA9IHRpbWVQcmV0dGllcihNYXRoLnJvdW5kKHBsYXllci5kdXJhdGlvbikpO1xyXG4gICAgY29uc3QgbWluc0luZm8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHJhbnNjcmlwdF9fY2FwdGlvbiBzcGFuJyk7XHJcbiAgICBpZiAobWluc0luZm8pIHtcclxuICAgICAgbWluc0luZm8uaW5uZXJIVE1MID0gZ2V0TWludXRlcyhNYXRoLnJvdW5kKHBsYXllci5kdXJhdGlvbikpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIHBsYXllclBsYXlTVkcuY2xhc3NMaXN0LmFkZChcInBsYXllcl9fcGxheS1zdmdfaXMtYWN0aXZlXCIpO1xyXG4gICAgcGxheWVyUGF1c2VTVkcuY2xhc3NMaXN0LnJlbW92ZShcInBsYXllcl9fcGF1c2Utc3ZnX2lzLWFjdGl2ZVwiKTtcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gdGltZVByZXR0aWVyKHRpbWUpIHtcclxuICAgIHZhciBzZWNfbnVtID0gcGFyc2VJbnQodGltZSwgMTApO1xyXG4gICAgdmFyIGhvdXJzICAgPSBNYXRoLmZsb29yKHNlY19udW0gLyAzNjAwKTtcclxuICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcigoc2VjX251bSAtIChob3VycyAqIDM2MDApKSAvIDYwKTtcclxuICAgIHZhciBzZWNvbmRzID0gc2VjX251bSAtIChob3VycyAqIDM2MDApIC0gKG1pbnV0ZXMgKiA2MCk7XHJcblxyXG4gICAgaWYgKGhvdXJzICAgPCAxMCkge2hvdXJzICAgPSBcIjBcIitob3Vyczt9XHJcbiAgICBpZiAobWludXRlcyA8IDEwKSB7bWludXRlcyA9IFwiMFwiK21pbnV0ZXM7fVxyXG4gICAgaWYgKHNlY29uZHMgPCAxMCkge3NlY29uZHMgPSBcIjBcIitzZWNvbmRzO31cclxuICAgIHJldHVybiBob3VycysnOicrbWludXRlcysnOicrc2Vjb25kcztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldE1pbnV0ZXModGltZSkge1xyXG4gICAgY29uc3Qgc2VjX251bSA9IHBhcnNlSW50KHRpbWUsIDEwKTtcclxuICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKChzZWNfbnVtIC8gNjApKTtcclxuXHJcbiAgICByZXR1cm4gbWludXRlcztcclxuICB9XHJcblxyXG4gIHBsYXllclBsYXkub25jbGljayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIGlmIChwbGF5ZXIucGF1c2VkKSB7XHJcbiAgICAgIHBsYXllci5wbGF5KCk7XHJcbiAgICAgIGN1cnJlbnRUaW1lID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgIGxldCB0aW1lID0gTWF0aC5yb3VuZChwbGF5ZXIuY3VycmVudFRpbWUpO1xyXG4gICAgICAgIHBsYXllckN1cnJlbnRUaW1lLmlubmVySFRNTCA9IHRpbWVQcmV0dGllcih0aW1lKTtcclxuXHJcbiAgICAgICAgcGxheWVyUHJvZ3Jlc3Muc3R5bGUud2lkdGggPSB0aW1lIC8gKHBsYXllci5kdXJhdGlvbiAvIDEwMCkgKyBcIiVcIjtcclxuICAgICAgfSwgNTAwKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHBsYXllci5wYXVzZSgpO1xyXG4gICAgICBjbGVhckludGVydmFsKGN1cnJlbnRUaW1lKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcihcInBsYXlcIiwgKCkgPT4ge1xyXG4gICAgcGxheWVyUGxheVNWRy5jbGFzc0xpc3QucmVtb3ZlKFwicGxheWVyX19wbGF5LXN2Z19pcy1hY3RpdmVcIik7XHJcbiAgICBwbGF5ZXJQYXVzZVNWRy5jbGFzc0xpc3QuYWRkKFwicGxheWVyX19wYXVzZS1zdmdfaXMtYWN0aXZlXCIpO1xyXG4gIH0pO1xyXG5cclxuICBwbGF5ZXIuYWRkRXZlbnRMaXN0ZW5lcihcInBhdXNlXCIsICgpID0+IHtcclxuICAgIHBsYXllclBsYXlTVkcuY2xhc3NMaXN0LmFkZChcInBsYXllcl9fcGxheS1zdmdfaXMtYWN0aXZlXCIpO1xyXG4gICAgcGxheWVyUGF1c2VTVkcuY2xhc3NMaXN0LnJlbW92ZShcInBsYXllcl9fcGF1c2Utc3ZnX2lzLWFjdGl2ZVwiKTtcclxuICB9KTtcclxuXHJcbiAgcGxheWVyUHJvZ3Jlc3NCYXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICBwbGF5ZXJQcm9ncmVzcy5zdHlsZS53aWR0aCA9IGdldFJlbGF0aXZlQ29vcmRpbmF0ZXMoZSwgZS50YXJnZXQpICsgXCJweFwiO1xyXG4gICAgcGxheWVyLmN1cnJlbnRUaW1lID1cclxuICAgICAgKHBsYXllci5kdXJhdGlvbiAvIDEwMCkgKlxyXG4gICAgICAoZ2V0UmVsYXRpdmVDb29yZGluYXRlcyhlLCBlLnRhcmdldCkgL1xyXG4gICAgICAgIChwbGF5ZXJQcm9ncmVzc0Jhci5vZmZzZXRXaWR0aCAvIDEwMCkpO1xyXG4gICAgbGV0IHRpbWUgPSBNYXRoLnJvdW5kKHBsYXllci5jdXJyZW50VGltZSk7XHJcbiAgICBwbGF5ZXJDdXJyZW50VGltZS5pbm5lckhUTUwgPSB0aW1lUHJldHRpZXIodGltZSk7XHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIGdldFJlbGF0aXZlQ29vcmRpbmF0ZXMoZXZlbnQsIHJlZmVyZW5jZUVsZW1lbnQpIHtcclxuICAgIGNvbnN0IHBvc2l0aW9uID0ge1xyXG4gICAgICB4OiBldmVudC5wYWdlWCxcclxuICAgICAgeTogZXZlbnQucGFnZVksXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IG9mZnNldCA9IHtcclxuICAgICAgbGVmdDogcmVmZXJlbmNlRWxlbWVudC5vZmZzZXRMZWZ0LFxyXG4gICAgICB0b3A6IHJlZmVyZW5jZUVsZW1lbnQub2Zmc2V0VG9wLFxyXG4gICAgfTtcclxuXHJcbiAgICBsZXQgcmVmZXJlbmNlID0gcmVmZXJlbmNlRWxlbWVudC5vZmZzZXRQYXJlbnQ7XHJcblxyXG4gICAgd2hpbGUgKHJlZmVyZW5jZSkge1xyXG4gICAgICBvZmZzZXQubGVmdCArPSByZWZlcmVuY2Uub2Zmc2V0TGVmdDtcclxuICAgICAgb2Zmc2V0LnRvcCArPSByZWZlcmVuY2Uub2Zmc2V0VG9wO1xyXG4gICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2Uub2Zmc2V0UGFyZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwb3NpdGlvbi54IC0gb2Zmc2V0LmxlZnQ7XHJcbiAgfVxyXG5cclxuICBwbGF5ZXJWb2x1bWUub25jbGljayA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHBsYXllclZvbHVtZVNWRy5jbGFzc0xpc3QudG9nZ2xlKFwicGxheWVyX192b2x1bWUtc3ZnX2lzLWFjdGl2ZVwiKTtcclxuICAgIHBsYXllclZvbHVtZU11dGVkU1ZHLmNsYXNzTGlzdC50b2dnbGUoXCJwbGF5ZXJfX3ZvbHVtZV9tdXRlZC1zdmdfaXMtYWN0aXZlXCIpO1xyXG4gICAgaWYgKCFwbGF5ZXIubXV0ZWQpIHtcclxuICAgICAgcGxheWVyLm11dGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHBsYXllci5tdXRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHBsYXllclZvbHVtZUJhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIHBsYXllclZvbHVtZVZhbHVlLnN0eWxlLmhlaWdodCA9IDcwIC0gZ2V0UmVsYXRpdmVDb29yZGluYXRlc1YoZSwgcGxheWVyVm9sdW1lQmFyKSArIFwicHhcIjtcclxuICAgIHBsYXllci52b2x1bWUgPSAxIC0gcGxheWVyVm9sdW1lVmFsdWUub2Zmc2V0VG9wIC8gKHBsYXllclZvbHVtZUJhci5vZmZzZXRUb3AgLyAxMDApIC8gLTEwMDtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd2b2x1bWUnLCBwbGF5ZXIudm9sdW1lKTtcclxuICAgIGNvbnNvbGUubG9nKHBsYXllci52b2x1bWUpO1xyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBnZXRSZWxhdGl2ZUNvb3JkaW5hdGVzVihldmVudCwgcmVmZXJlbmNlRWxlbWVudCkge1xyXG4gICAgY29uc3QgcG9zaXRpb24gPSB7XHJcbiAgICAgIHg6IGV2ZW50LnBhZ2VYLFxyXG4gICAgICB5OiBldmVudC5wYWdlWSxcclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qgb2Zmc2V0ID0ge1xyXG4gICAgICBsZWZ0OiByZWZlcmVuY2VFbGVtZW50Lm9mZnNldExlZnQsXHJcbiAgICAgIHRvcDogcmVmZXJlbmNlRWxlbWVudC5vZmZzZXRUb3AsXHJcbiAgICB9O1xyXG5cclxuICAgIGxldCByZWZlcmVuY2UgPSByZWZlcmVuY2VFbGVtZW50Lm9mZnNldFBhcmVudDtcclxuXHJcbiAgICB3aGlsZSAocmVmZXJlbmNlKSB7XHJcbiAgICAgIG9mZnNldC5sZWZ0ICs9IHJlZmVyZW5jZS5vZmZzZXRMZWZ0O1xyXG4gICAgICBvZmZzZXQudG9wICs9IHJlZmVyZW5jZS5vZmZzZXRUb3A7XHJcbiAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5vZmZzZXRQYXJlbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBvc2l0aW9uLnkgLSBvZmZzZXQudG9wO1xyXG4gIH1cclxufVxyXG4iLCJTaGFyZSA9IHtcclxuICB2a29udGFrdGU6IGZ1bmN0aW9uIChwdXJsLCBwdGl0bGUsIHBpbWcsIHRleHQpIHtcclxuICAgIHVybCA9IFwiaHR0cDovL3Zrb250YWt0ZS5ydS9zaGFyZS5waHA/XCI7XHJcbiAgICB1cmwgKz0gXCJ1cmw9XCIgKyBlbmNvZGVVUklDb21wb25lbnQocHVybCk7XHJcbiAgICB1cmwgKz0gXCImdGl0bGU9XCIgKyBlbmNvZGVVUklDb21wb25lbnQocHRpdGxlKTtcclxuICAgIHVybCArPSBcIiZkZXNjcmlwdGlvbj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh0ZXh0KTtcclxuICAgIHVybCArPSBcIiZpbWFnZT1cIiArIGVuY29kZVVSSUNvbXBvbmVudChwaW1nKTtcclxuICAgIHVybCArPSBcIiZub3BhcnNlPXRydWVcIjtcclxuICAgIFNoYXJlLnBvcHVwKHVybCk7XHJcbiAgfSxcclxuICBmYWNlYm9vazogZnVuY3Rpb24gKHB1cmwsIHB0aXRsZSwgcGltZywgdGV4dCkge1xyXG4gICAgdXJsID0gXCJodHRwOi8vd3d3LmZhY2Vib29rLmNvbS9zaGFyZXIucGhwP3M9MTAwXCI7XHJcbiAgICB1cmwgKz0gXCImcFt0aXRsZV09XCIgKyBlbmNvZGVVUklDb21wb25lbnQocHRpdGxlKTtcclxuICAgIHVybCArPSBcIiZwW3N1bW1hcnldPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHRleHQpO1xyXG4gICAgdXJsICs9IFwiJnBbdXJsXT1cIiArIGVuY29kZVVSSUNvbXBvbmVudChwdXJsKTtcclxuICAgIHVybCArPSBcIiZwW2ltYWdlc11bMF09XCIgKyBlbmNvZGVVUklDb21wb25lbnQocGltZyk7XHJcbiAgICBTaGFyZS5wb3B1cCh1cmwpO1xyXG4gIH0sXHJcbiAgdHdpdHRlcjogZnVuY3Rpb24gKHB1cmwsIHB0aXRsZSkge1xyXG4gICAgdXJsID0gXCJodHRwOi8vdHdpdHRlci5jb20vc2hhcmU/XCI7XHJcbiAgICB1cmwgKz0gXCJ0ZXh0PVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHB0aXRsZSk7XHJcbiAgICB1cmwgKz0gXCImdXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHB1cmwpO1xyXG4gICAgdXJsICs9IFwiJmNvdW50dXJsPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHB1cmwpO1xyXG4gICAgU2hhcmUucG9wdXAodXJsKTtcclxuICB9LFxyXG5cclxuICBwb3B1cDogZnVuY3Rpb24gKHVybCkge1xyXG4gICAgd2luZG93Lm9wZW4odXJsLCBcIlwiLCBcInRvb2xiYXI9MCxzdGF0dXM9MCx3aWR0aD02MjYsaGVpZ2h0PTQzNlwiKTtcclxuICB9LFxyXG59O1xyXG4iLCJjb25zdCBwcm9kdWN0QnRucyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9kdWN0LXRhYnNfX2J0blwiKSk7XHJcbmNvbnN0IHByb2R1Y3RUYWJzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2R1Y3QtZGVzY3JfX2l0ZW1cIikpO1xyXG5jb25zdCBwcm9kdWN0UmV2aWV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yYXRpbmdfX2xpbmtcIik7XHJcblxyXG5mdW5jdGlvbiByZXZpZXdDbGljayhwcm9kdWN0VGFicywgcHJvZHVjdEJ0bnMpIHtcclxuICBwcm9kdWN0VGFicy5tYXAoKHRhYikgPT4ge1xyXG4gICAgdGFiLmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9kdWN0LWRlc2NyX19pdGVtX2FjdGl2ZVwiKTtcclxuICAgIGlmICh0YWIuaWQgPT09IFwicmV2aWV3XCIpIHtcclxuICAgICAgdGFiLmNsYXNzTGlzdC5hZGQoXCJwcm9kdWN0LWRlc2NyX19pdGVtX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9KTtcclxuICBwcm9kdWN0QnRucy5tYXAoKGJ0bikgPT4ge1xyXG4gICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoXCJwcm9kdWN0LXRhYnNfX2J0bl9hY3RpdmVcIik7XHJcbiAgICBpZiAoYnRuLmRhdGFzZXQudGFiID09PSBcInJldmlld1wiKSB7XHJcbiAgICAgIGJ0bi5jbGFzc0xpc3QuYWRkKFwicHJvZHVjdC10YWJzX19idG5fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5pZiAocHJvZHVjdFJldmlldykge1xyXG4gIHByb2R1Y3RSZXZpZXcuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldmlld0NsaWNrKHByb2R1Y3RUYWJzLCBwcm9kdWN0QnRucyk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbnByb2R1Y3RCdG5zLm1hcCgoYnRuKSA9PiB7XHJcbiAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBwcm9kdWN0VGFicy5tYXAoKHRhYikgPT4ge1xyXG4gICAgICB0YWIuY2xhc3NMaXN0LnJlbW92ZShcInByb2R1Y3QtZGVzY3JfX2l0ZW1fYWN0aXZlXCIpO1xyXG4gICAgICBpZiAoYnRuLmRhdGFzZXQudGFiID09PSB0YWIuaWQpIHtcclxuICAgICAgICB0YWIuY2xhc3NMaXN0LmFkZChcInByb2R1Y3QtZGVzY3JfX2l0ZW1fYWN0aXZlXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIHByb2R1Y3RCdG5zLm1hcCgoYnRuKSA9PiB7XHJcbiAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwicHJvZHVjdC10YWJzX19idG5fYWN0aXZlXCIpO1xyXG4gICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJwcm9kdWN0LXRhYnNfX2J0bl9hY3RpdmVcIik7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcblxyXG5jb25zdCBhY2NCdG5zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmFjY291bnQtdGFic19fYnRuXCIpKTtcclxuY29uc3QgYWNjVGFicyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5hY2NvdW50LWl0ZW1cIikpO1xyXG5cclxuYWNjQnRucy5tYXAoKGJ0bikgPT4ge1xyXG4gIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgYWNjVGFicy5tYXAoKHRhYikgPT4ge1xyXG4gICAgICB0YWIuY2xhc3NMaXN0LmFkZChcImFjY291bnQtaXRlbV9oaWRkZW5cIik7XHJcbiAgICAgIGlmIChidG4uZGF0YXNldC50YWIgPT09IHRhYi5pZCkge1xyXG4gICAgICAgIHRhYi5jbGFzc0xpc3QucmVtb3ZlKFwiYWNjb3VudC1pdGVtX2hpZGRlblwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBhY2NCdG5zLm1hcCgoYnRuKSA9PiB7XHJcbiAgICAgIGJ0bi5jbGFzc0xpc3QucmVtb3ZlKFwiYWNjb3VudC10YWJzX19idG5fYWN0aXZlXCIpO1xyXG4gICAgICB0aGlzLmNsYXNzTGlzdC5hZGQoXCJhY2NvdW50LXRhYnNfX2J0bl9hY3RpdmVcIik7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdfQ==
